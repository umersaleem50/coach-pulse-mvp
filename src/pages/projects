import EmptyProjectCard from "@/features/projects/components/EmptyProjectCard";
import LoadingProjects from "@/features/projects/components/LoadingProjects";
import ProjectCard from "@/features/projects/components/ProjectCard";
import { useProjects } from "@/features/projects/hooks/useProjects";
import { Page } from "@/shared/components/page";
import ErrorCard from "@/shared/components/ErrorCard";
import type { Project } from "@/types/project";
import NewProjectCard from "@/features/projects/components/NewProjectCard";
import { Button } from "@/shared/components/ui/button";
import { Plus } from "lucide-react";

function AllProjectsPage() {
  const {
    isLoadingProjects,
    projects = [],
    projectsError,
    refetch,
  } = useProjects();

  return (
    <Page
      title={"Projects"}
      actions={
        <Button>
          <Plus />
          Create Project
        </Button>
      }
    >
      <div className="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 lg:p-4">
        <ErrorCard error={projectsError} onRetry={refetch} />
        {isLoadingProjects && <LoadingProjects numOfProjects={3} />}
        {!isLoadingProjects && !projects.length && !projectsError ? (
          <EmptyProjectCard />
        ) : null}
        {projects.map((project: Project) => (
          <ProjectCard {...project} key={project.id} />
        ))}
        {projects?.length ? <NewProjectCard /> : null}
      </div>
    </Page>
  );
}

export default AllProjectsPage;
